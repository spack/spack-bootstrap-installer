<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFilesFolder">
				<Directory Id="APPLICATIONROOTDIRECTORY" Name="Spack"/>
			</Directory>
			<!-- Step 1: Define the directory structure -->
			<Directory Id="ProgramMenuFolder">
				<Directory Id="ApplicationProgramsFolder" Name="Spack"/>
			</Directory>
		</Directory>
		<DirectoryRef Id="APPLICATIONROOTDIRECTORY">
			<Component Id="Spack.lnk" Guid="*">
				<File Id="Spack.lnk" Source="scripts\Spack.lnk" KeyPath="yes" Checksum="yes"/>
			</Component>
		</DirectoryRef>
		<!-- Step 2: Add the shortcut to your installer package -->
		<DirectoryRef Id="ApplicationProgramsFolder">
			<Component Id="ApplicationShortcut" Guid="*">
				<Shortcut Id="ApplicationStartMenuShortcut"
                     Name="Spack Package Manager"
                   Description="Spack package manager"
                    Target="[#Spack.lnk]"
                          WorkingDirectory="APPLICATIONROOTDIRECTORY"/>
				<RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
				<RegistryValue Root="HKCU" Key="Software\LLNL\Spack" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
			</Component>
		</DirectoryRef>

		<Feature Id="MainApplication" Title="Main Application" Level="1">
			<ComponentRef Id="myapplication.exe" />
			<ComponentRef Id="documentation.html" />
			<!-- Step 3: Tell WiX to install the shortcut -->
			<ComponentRef Id="ApplicationShortcut" />
		</Feature>
	</Fragment>
</Wix>